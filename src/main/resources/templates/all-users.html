<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>All Users</title>

    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            background-color: #f3f1e7;
        }

        .container-box {
            margin-top: 60px;
            max-width: 1000px;
        }

        .card {
            border-radius: 18px;
        }

        th {
            background: #3a6ea5;
            color: white;
        }

        .action-buttons {
            display: flex;
            gap: 8px;
            justify-content: center;
        }

        .btn-action {
            padding: 5px 14px;
            font-size: 0.8rem;
            border-radius: 8px;
            text-decoration: none;
            color: white;
            font-weight: 500;
        }

        .btn-edit {
            background-color: #ffc107;
            color: #000;
        }

        .btn-delete {
            background-color: #dc3545;
        }

        .btn-action:hover {
            opacity: 0.85;
        }
    </style>
</head>

<body>

<div class="container container-box">
    <div class="card shadow p-4">

        <form method="get" th:action="@{/user/search}" class="row g-2 mb-4">

            <!-- Full Name -->
            <div class="col-md-3">
                <input type="text" name="fullName"
                       class="form-control"
                       placeholder="Name starts with">
            </div>

            <!-- Username -->
            <div class="col-md-2">
                <input type="text" name="username"
                       class="form-control"
                       placeholder="Username">
            </div>

            <!-- Phone -->
            <div class="col-md-2">
                <input type="text" name="phoneNumber"
                       class="form-control"
                       placeholder="Phone">
            </div>

            <!-- Age -->
            <div class="col-md-1">
                <input type="number" name="age"
                       class="form-control"
                       placeholder="Age">
            </div>

            <!-- Role -->
            <div class="col-md-2">
                <select name="role" class="form-select">
                    <option value="">All Roles</option>
                    <option value="STUDENT">Student</option>
                    <option value="TEACHER">Teacher</option>
                </select>
            </div>

            <!-- Status -->
            <div class="col-md-2">
                <select name="status" class="form-select">
                    <option value="">All Status</option>
                    <option value="PENDING">Pending</option>
                    <option value="APPROVED">Approved</option>
                    <option value="REJECTED">Rejected</option>
                </select>
            </div>

            <!-- Submit -->
            <div class="col-md-2">
                <button class="btn btn-primary w-100">Search</button>
            </div>

        </form>

        <div th:if="${updateMessage}" style="margin-bottom:15px; color:green;">
            <span th:text="${updateMessage}"></span>
        </div>

        <div th:if="${deleteMessage}" style="margin-bottom:15px; color:green;">
            <span th:text="${deleteMessage}"></span>
        </div>

        <h2 class="text-center mb-4">All Users</h2>

        <table class="table table-bordered table-hover table-striped text-center">
            <thead>
            <tr>
                <th>Full Name</th>
                <th>Phone Number</th>
                <th>Age</th>
                <th>Username</th>
                <th>Role</th>
                <th>Status</th>
                <th>Active</th>
                <th style="width: 200px;">Actions</th>
            </tr>
            </thead>

            <tbody>
            <tr th:each="u : ${allUsers}">
                <td th:text="${u.fullName}"></td>
                <td th:text="${u.phoneNumber}"></td>
                <td th:text="${u.age}"></td>
                <td th:text="${u.username}"></td>
                <td th:text="${u.role}"></td>
                <td th:text="${u.userStatus}"></td>
                <td>
                    <span th:text="${u.active()} ? 'Active' : 'DeActive'"></span>
                </td>

                <td>
                    <div class="action-buttons" th:if="${u.role != 'MANAGER'}">

                        <!-- EDIT -->
                        <a th:href="@{/user/edit/{username}(username=${u.username})}"
                           class="btn-action btn-edit">
                            ‚úèÔ∏è Edit
                        </a>

                        <!-- DELETE -->
                        <a th:href="@{/user/delete/{username}(username=${u.username})}"
                           class="btn-action btn-delete"
                           onclick="return confirm('Are you sure you want to delete this user?');">
                            üóë Delete
                        </a>

                    </div>
                </td>
            </tr>
            </tbody>
        </table>

        <div class="text-center mt-4">
            <a class="btn btn-secondary px-4" th:href="@{/dashboard}">
                ‚¨Ö Back to Dashboard
            </a>
        </div>

    </div>
</div>

</body>
</html>
